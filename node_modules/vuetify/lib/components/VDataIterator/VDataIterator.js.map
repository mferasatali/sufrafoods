{"version":3,"file":"VDataIterator.js","names":["VFadeTransition","makeDataTableExpandProps","provideExpanded","makeDataTableGroupProps","provideGroupBy","useGroupedItems","useOptions","createPagination","makeDataTablePaginateProps","providePagination","usePaginatedItems","makeDataTableSelectProps","provideSelection","createSort","makeDataTableSortProps","provideSort","useSortedItems","makeDataIteratorItemsProps","useDataIteratorItems","makeComponentProps","makeFilterProps","useFilter","LoaderSlot","useProxiedModel","makeTagProps","useToggleScope","makeTransitionProps","MaybeTransition","computed","shallowRef","toRef","watchEffect","genericComponent","isEmpty","propsFactory","useRender","makeVDataIteratorProps","search","String","loading","Boolean","itemsLength","Number","itemsPerPage","transition","component","hideOnLeave","VDataIterator","name","props","emits","value","setup","_ref","slots","groupBy","items","filteredItems","transform","item","raw","initialSortOrder","sortBy","multiSort","mustSort","page","toggleSort","sortByWithGroups","opened","extractRows","isGroupOpen","toggleGroup","sortedItems","flatItems","manualPagination","length","startIndex","stopIndex","pageCount","prevPage","nextPage","setItemsPerPage","setPage","paginatedItems","currentItems","currentItemsWithoutGroups","isSelected","select","selectAll","toggleSelect","allItems","currentPage","isExpanded","toggleExpand","slotProps","itemsCount","groupedItems","_createVNode","tag","_normalizeClass","class","_normalizeStyle","style","default","header","loader","_createElementVNode","footer"],"sources":["../../../src/components/VDataIterator/VDataIterator.tsx"],"sourcesContent":["// Components\nimport { VFadeTransition } from '@/components/transitions'\nimport { makeDataTableExpandProps, provideExpanded } from '@/components/VDataTable/composables/expand'\nimport { makeDataTableGroupProps, provideGroupBy, useGroupedItems } from '@/components/VDataTable/composables/group'\nimport { useOptions } from '@/components/VDataTable/composables/options'\nimport {\n  createPagination,\n  makeDataTablePaginateProps,\n  providePagination,\n  usePaginatedItems,\n} from '@/components/VDataTable/composables/paginate'\nimport { makeDataTableSelectProps, provideSelection } from '@/components/VDataTable/composables/select'\nimport { createSort, makeDataTableSortProps, provideSort, useSortedItems } from '@/components/VDataTable/composables/sort'\n\n// Composables\nimport { makeDataIteratorItemsProps, useDataIteratorItems } from './composables/items'\nimport { makeComponentProps } from '@/composables/component'\nimport { makeFilterProps, useFilter } from '@/composables/filter'\nimport { LoaderSlot } from '@/composables/loader'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { makeTagProps } from '@/composables/tag'\nimport { useToggleScope } from '@/composables/toggleScope'\nimport { makeTransitionProps, MaybeTransition } from '@/composables/transition'\n\n// Utilities\nimport { computed, shallowRef, toRef, watchEffect } from 'vue'\nimport { genericComponent, isEmpty, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { Component } from 'vue'\nimport type { DataIteratorItem } from './composables/items'\nimport type { Group, GroupSummary } from '@/components/VDataTable/composables/group'\nimport type { SortItem } from '@/components/VDataTable/composables/sort'\nimport type { LoaderSlotProps } from '@/composables/loader'\nimport type { GenericProps } from '@/util'\n\ntype VDataIteratorSlotProps<T> = {\n  page: number\n  itemsPerPage: number\n  sortBy: readonly SortItem[]\n  pageCount: number\n  toggleSort: ReturnType<typeof provideSort>['toggleSort']\n  prevPage: ReturnType<typeof providePagination>['prevPage']\n  nextPage: ReturnType<typeof providePagination>['nextPage']\n  setPage: ReturnType<typeof providePagination>['setPage']\n  setItemsPerPage: ReturnType<typeof providePagination>['setItemsPerPage']\n  isSelected: ReturnType<typeof provideSelection>['isSelected']\n  select: ReturnType<typeof provideSelection>['select']\n  selectAll: ReturnType<typeof provideSelection>['selectAll']\n  toggleSelect: ReturnType<typeof provideSelection>['toggleSelect']\n  isExpanded: ReturnType<typeof provideExpanded>['isExpanded']\n  toggleExpand: ReturnType<typeof provideExpanded>['toggleExpand']\n  isGroupOpen: ReturnType<typeof provideGroupBy>['isGroupOpen']\n  toggleGroup: ReturnType<typeof provideGroupBy>['toggleGroup']\n  items: readonly DataIteratorItem<T>[]\n  itemsCount: number\n  groupedItems: readonly (DataIteratorItem<T> | Group<DataIteratorItem<T>> | GroupSummary<DataIteratorItem<T>>)[]\n}\n\nexport type VDataIteratorSlots<T> = {\n  default: VDataIteratorSlotProps<T>\n  header: VDataIteratorSlotProps<T>\n  footer: VDataIteratorSlotProps<T>\n  loader: LoaderSlotProps\n  'no-data': never\n}\n\nexport const makeVDataIteratorProps = propsFactory({\n  search: String,\n  loading: Boolean,\n  itemsLength: [Number, String],\n\n  ...makeComponentProps(),\n  ...makeDataIteratorItemsProps(),\n  ...makeDataTableSelectProps(),\n  ...makeDataTableSortProps(),\n  ...makeDataTablePaginateProps({ itemsPerPage: 5 }),\n  ...makeDataTableExpandProps(),\n  ...makeDataTableGroupProps(),\n  ...makeFilterProps(),\n  ...makeTagProps(),\n  ...makeTransitionProps({\n    transition: {\n      component: VFadeTransition as Component,\n      hideOnLeave: true,\n    },\n  }),\n}, 'VDataIterator')\n\nexport const VDataIterator = genericComponent<new <T> (\n  props: {\n    items?: readonly T[]\n  },\n  slots: VDataIteratorSlots<T>,\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VDataIterator',\n\n  props: makeVDataIteratorProps(),\n\n  emits: {\n    'update:modelValue': (value: any[]) => true,\n    'update:groupBy': (value: any) => true,\n    'update:page': (value: number) => true,\n    'update:itemsPerPage': (value: number) => true,\n    'update:sortBy': (value: any) => true,\n    'update:options': (value: any) => true,\n    'update:expanded': (value: any) => true,\n    'update:currentItems': (value: any) => true,\n  },\n\n  setup (props, { slots }) {\n    const groupBy = useProxiedModel(props, 'groupBy')\n    const search = toRef(() => props.search)\n\n    const { items } = useDataIteratorItems(props)\n    const { filteredItems } = useFilter(props, items, search, { transform: item => item.raw })\n\n    const { initialSortOrder, sortBy, multiSort, mustSort } = createSort(props)\n    const { page, itemsPerPage } = createPagination(props)\n\n    const { toggleSort } = provideSort({ initialSortOrder, sortBy, multiSort, mustSort, page })\n    const { sortByWithGroups, opened, extractRows, isGroupOpen, toggleGroup } = provideGroupBy({ groupBy, sortBy })\n\n    const { sortedItems } = useSortedItems(props, filteredItems, sortByWithGroups, { transform: item => item.raw })\n    const { flatItems } = useGroupedItems(sortedItems, groupBy, opened, false)\n\n    const manualPagination = toRef(() => !isEmpty(props.itemsLength))\n    const itemsLength = toRef(() => manualPagination.value ? Number(props.itemsLength) : flatItems.value.length)\n\n    const {\n      startIndex,\n      stopIndex,\n      pageCount,\n      prevPage,\n      nextPage,\n      setItemsPerPage,\n      setPage,\n    } = providePagination({ page, itemsPerPage, itemsLength })\n\n    const paginatedItems = shallowRef<typeof flatItems.value>([])\n    const currentItems = computed(() => manualPagination.value ? flatItems.value : paginatedItems.value)\n\n    useToggleScope(() => !manualPagination.value, () => {\n      const { paginatedItems: items } = usePaginatedItems({ items: flatItems, startIndex, stopIndex, itemsPerPage })\n\n      watchEffect(() => {\n        paginatedItems.value = items.value\n      })\n    })\n\n    const currentItemsWithoutGroups = computed(() => extractRows(currentItems.value))\n\n    const {\n      isSelected,\n      select,\n      selectAll,\n      toggleSelect,\n    } = provideSelection(props, { allItems: items, currentPage: currentItemsWithoutGroups })\n    const { isExpanded, toggleExpand } = provideExpanded(props)\n\n    useOptions({\n      page,\n      itemsPerPage,\n      sortBy,\n      groupBy,\n      search,\n    })\n\n    const slotProps = computed(() => ({\n      page: page.value,\n      itemsPerPage: itemsPerPage.value,\n      sortBy: sortBy.value,\n      pageCount: pageCount.value,\n      toggleSort,\n      prevPage,\n      nextPage,\n      setPage,\n      setItemsPerPage,\n      isSelected,\n      select,\n      selectAll,\n      toggleSelect,\n      isExpanded,\n      toggleExpand,\n      isGroupOpen,\n      toggleGroup,\n      items: currentItemsWithoutGroups.value,\n      itemsCount: filteredItems.value.length,\n      groupedItems: currentItems.value,\n    }))\n\n    useRender(() => (\n      <props.tag\n        class={[\n          'v-data-iterator',\n          {\n            'v-data-iterator--loading': props.loading,\n          },\n          props.class,\n        ]}\n        style={ props.style }\n      >\n        { slots.header?.(slotProps.value) }\n\n        <MaybeTransition transition={ props.transition }>\n          { props.loading ? (\n            <LoaderSlot key=\"loader\" name=\"v-data-iterator\" active>\n              { slotProps => slots.loader?.(slotProps) }\n            </LoaderSlot>\n          ) : (\n            <div key=\"items\">\n              { !currentItems.value.length\n                ? slots['no-data']?.()\n                : slots.default?.(slotProps.value)\n              }\n            </div>\n          )}\n        </MaybeTransition>\n\n        { slots.footer?.(slotProps.value) }\n      </props.tag>\n    ))\n\n    return {}\n  },\n})\n\nexport type VDataIterator = InstanceType<typeof VDataIterator>\n"],"mappings":"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","ignoreList":[]}