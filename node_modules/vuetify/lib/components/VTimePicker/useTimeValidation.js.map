{"version":3,"file":"useTimeValidation.js","names":["computed","incrementHour","incrementMinuteOrSecond","propsFactory","makeTimeValidationProps","allowedHours","Function","Array","allowedMinutes","allowedSeconds","max","String","min","useTimeValidation","props","isAllowedHour","minHour","Number","split","maxHour","val","isArray","includes","isAllowedMinute","minMinute","map","maxMinute","minTime","maxTime","hour24hr","time","isAllowedSecond","minSecond","maxSecond","minute","findNextAllowed","type","value","increment","currentHour","arguments","length","undefined","currentMinute","isAllowed","v","nextValue","limit","i"],"sources":["../../../src/components/VTimePicker/useTimeValidation.ts"],"sourcesContent":["// Utilities\nimport { computed } from 'vue'\nimport { incrementHour, incrementMinuteOrSecond } from './util'\nimport { propsFactory } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { VTimePickerViewMode } from './shared'\n\nexport type AllowFunction = (val: number) => boolean\n\nexport const makeTimeValidationProps = propsFactory({\n  allowedHours: [Function, Array] as PropType<AllowFunction | number[]>,\n  allowedMinutes: [Function, Array] as PropType<AllowFunction | number[]>,\n  allowedSeconds: [Function, Array] as PropType<AllowFunction | number[]>,\n  max: String,\n  min: String,\n}, 'time-validation')\n\nexport interface TimeValidationProps {\n  allowedHours?: AllowFunction | number[]\n  allowedMinutes?: AllowFunction | number[]\n  allowedSeconds?: AllowFunction | number[]\n  min?: string\n  max?: string\n}\n\nexport function useTimeValidation (props: TimeValidationProps) {\n  const isAllowedHour = computed(() => {\n    const minHour = props.min ? Number(props.min.split(':')[0]) : 0\n    const maxHour = props.max ? Number(props.max.split(':')[0]) : 23\n\n    return (val: number) => {\n      if (val < minHour) return false\n      if (val > maxHour) return false\n      if (Array.isArray(props.allowedHours)) return props.allowedHours.includes(val)\n      if (typeof props.allowedHours === 'function') return props.allowedHours(val)\n      return true\n    }\n  })\n\n  const isAllowedMinute = computed(() => {\n    const [minHour, minMinute] = props.min ? props.min.split(':').map(Number) : [0, 0]\n    const [maxHour, maxMinute] = props.max ? props.max.split(':').map(Number) : [23, 59]\n    const minTime = minHour * 60 + minMinute\n    const maxTime = maxHour * 60 + maxMinute\n\n    return (hour24hr: number | null, val: number) => {\n      if (hour24hr !== null) {\n        const time = 60 * hour24hr + val\n        if (time < minTime) return false\n        if (time > maxTime) return false\n      }\n      if (Array.isArray(props.allowedMinutes)) return props.allowedMinutes.includes(val)\n      if (typeof props.allowedMinutes === 'function') return props.allowedMinutes(val)\n      return true\n    }\n  })\n\n  const isAllowedSecond = computed(() => {\n    const [minHour, minMinute, minSecond] = props.min ? props.min.split(':').map(Number) : [0, 0, 0]\n    const [maxHour, maxMinute, maxSecond] = props.max ? props.max.split(':').map(Number) : [23, 59, 59]\n    const minTime = minHour * 3600 + minMinute * 60 + (minSecond || 0)\n    const maxTime = maxHour * 3600 + maxMinute * 60 + (maxSecond || 0)\n\n    return (hour24hr: number | null, minute: number | null, val: number) => {\n      if (hour24hr !== null && minute !== null) {\n        const time = 3600 * hour24hr + 60 * minute + val\n        if (time < minTime) return false\n        if (time > maxTime) return false\n      }\n      if (Array.isArray(props.allowedSeconds)) return props.allowedSeconds.includes(val)\n      if (typeof props.allowedSeconds === 'function') return props.allowedSeconds(val)\n      return true\n    }\n  })\n\n  function findNextAllowed (\n    type: VTimePickerViewMode,\n    value: number,\n    increment: boolean,\n    currentHour: number | null = null,\n    currentMinute: number | null = null\n  ): number {\n    const isAllowed = type === 'hour'\n      ? isAllowedHour.value\n      : type === 'minute'\n        ? (v: number) => isAllowedMinute.value(currentHour, v)\n        : (v: number) => isAllowedSecond.value(currentHour, currentMinute, v)\n\n    const nextValue = type === 'hour'\n      ? (v: number) => incrementHour(v, increment, null).value\n      : (v: number) => incrementMinuteOrSecond(v, increment)\n\n    const limit = type === 'hour' ? 24 : 60\n    for (let i = 1; i <= limit; i++) {\n      value = nextValue(value)\n      if (isAllowed(value)) break\n    }\n    return value\n  }\n\n  return {\n    isAllowedHour,\n    isAllowedMinute,\n    isAllowedSecond,\n    findNextAllowed,\n  }\n}\n"],"mappings":"AAAA;AACA,SAASA,QAAQ,QAAQ,KAAK;AAAA,SACrBC,aAAa,EAAEC,uBAAuB;AAAA,SACtCC,YAAY,+BAErB;AAMA,OAAO,MAAMC,uBAAuB,GAAGD,YAAY,CAAC;EAClDE,YAAY,EAAE,CAACC,QAAQ,EAAEC,KAAK,CAAuC;EACrEC,cAAc,EAAE,CAACF,QAAQ,EAAEC,KAAK,CAAuC;EACvEE,cAAc,EAAE,CAACH,QAAQ,EAAEC,KAAK,CAAuC;EACvEG,GAAG,EAAEC,MAAM;EACXC,GAAG,EAAED;AACP,CAAC,EAAE,iBAAiB,CAAC;AAUrB,OAAO,SAASE,iBAAiBA,CAAEC,KAA0B,EAAE;EAC7D,MAAMC,aAAa,GAAGf,QAAQ,CAAC,MAAM;IACnC,MAAMgB,OAAO,GAAGF,KAAK,CAACF,GAAG,GAAGK,MAAM,CAACH,KAAK,CAACF,GAAG,CAACM,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;IAC/D,MAAMC,OAAO,GAAGL,KAAK,CAACJ,GAAG,GAAGO,MAAM,CAACH,KAAK,CAACJ,GAAG,CAACQ,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE;IAEhE,OAAQE,GAAW,IAAK;MACtB,IAAIA,GAAG,GAAGJ,OAAO,EAAE,OAAO,KAAK;MAC/B,IAAII,GAAG,GAAGD,OAAO,EAAE,OAAO,KAAK;MAC/B,IAAIZ,KAAK,CAACc,OAAO,CAACP,KAAK,CAACT,YAAY,CAAC,EAAE,OAAOS,KAAK,CAACT,YAAY,CAACiB,QAAQ,CAACF,GAAG,CAAC;MAC9E,IAAI,OAAON,KAAK,CAACT,YAAY,KAAK,UAAU,EAAE,OAAOS,KAAK,CAACT,YAAY,CAACe,GAAG,CAAC;MAC5E,OAAO,IAAI;IACb,CAAC;EACH,CAAC,CAAC;EAEF,MAAMG,eAAe,GAAGvB,QAAQ,CAAC,MAAM;IACrC,MAAM,CAACgB,OAAO,EAAEQ,SAAS,CAAC,GAAGV,KAAK,CAACF,GAAG,GAAGE,KAAK,CAACF,GAAG,CAACM,KAAK,CAAC,GAAG,CAAC,CAACO,GAAG,CAACR,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;IAClF,MAAM,CAACE,OAAO,EAAEO,SAAS,CAAC,GAAGZ,KAAK,CAACJ,GAAG,GAAGI,KAAK,CAACJ,GAAG,CAACQ,KAAK,CAAC,GAAG,CAAC,CAACO,GAAG,CAACR,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;IACpF,MAAMU,OAAO,GAAGX,OAAO,GAAG,EAAE,GAAGQ,SAAS;IACxC,MAAMI,OAAO,GAAGT,OAAO,GAAG,EAAE,GAAGO,SAAS;IAExC,OAAO,CAACG,QAAuB,EAAET,GAAW,KAAK;MAC/C,IAAIS,QAAQ,KAAK,IAAI,EAAE;QACrB,MAAMC,IAAI,GAAG,EAAE,GAAGD,QAAQ,GAAGT,GAAG;QAChC,IAAIU,IAAI,GAAGH,OAAO,EAAE,OAAO,KAAK;QAChC,IAAIG,IAAI,GAAGF,OAAO,EAAE,OAAO,KAAK;MAClC;MACA,IAAIrB,KAAK,CAACc,OAAO,CAACP,KAAK,CAACN,cAAc,CAAC,EAAE,OAAOM,KAAK,CAACN,cAAc,CAACc,QAAQ,CAACF,GAAG,CAAC;MAClF,IAAI,OAAON,KAAK,CAACN,cAAc,KAAK,UAAU,EAAE,OAAOM,KAAK,CAACN,cAAc,CAACY,GAAG,CAAC;MAChF,OAAO,IAAI;IACb,CAAC;EACH,CAAC,CAAC;EAEF,MAAMW,eAAe,GAAG/B,QAAQ,CAAC,MAAM;IACrC,MAAM,CAACgB,OAAO,EAAEQ,SAAS,EAAEQ,SAAS,CAAC,GAAGlB,KAAK,CAACF,GAAG,GAAGE,KAAK,CAACF,GAAG,CAACM,KAAK,CAAC,GAAG,CAAC,CAACO,GAAG,CAACR,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IAChG,MAAM,CAACE,OAAO,EAAEO,SAAS,EAAEO,SAAS,CAAC,GAAGnB,KAAK,CAACJ,GAAG,GAAGI,KAAK,CAACJ,GAAG,CAACQ,KAAK,CAAC,GAAG,CAAC,CAACO,GAAG,CAACR,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;IACnG,MAAMU,OAAO,GAAGX,OAAO,GAAG,IAAI,GAAGQ,SAAS,GAAG,EAAE,IAAIQ,SAAS,IAAI,CAAC,CAAC;IAClE,MAAMJ,OAAO,GAAGT,OAAO,GAAG,IAAI,GAAGO,SAAS,GAAG,EAAE,IAAIO,SAAS,IAAI,CAAC,CAAC;IAElE,OAAO,CAACJ,QAAuB,EAAEK,MAAqB,EAAEd,GAAW,KAAK;MACtE,IAAIS,QAAQ,KAAK,IAAI,IAAIK,MAAM,KAAK,IAAI,EAAE;QACxC,MAAMJ,IAAI,GAAG,IAAI,GAAGD,QAAQ,GAAG,EAAE,GAAGK,MAAM,GAAGd,GAAG;QAChD,IAAIU,IAAI,GAAGH,OAAO,EAAE,OAAO,KAAK;QAChC,IAAIG,IAAI,GAAGF,OAAO,EAAE,OAAO,KAAK;MAClC;MACA,IAAIrB,KAAK,CAACc,OAAO,CAACP,KAAK,CAACL,cAAc,CAAC,EAAE,OAAOK,KAAK,CAACL,cAAc,CAACa,QAAQ,CAACF,GAAG,CAAC;MAClF,IAAI,OAAON,KAAK,CAACL,cAAc,KAAK,UAAU,EAAE,OAAOK,KAAK,CAACL,cAAc,CAACW,GAAG,CAAC;MAChF,OAAO,IAAI;IACb,CAAC;EACH,CAAC,CAAC;EAEF,SAASe,eAAeA,CACtBC,IAAyB,EACzBC,KAAa,EACbC,SAAkB,EAGV;IAAA,IAFRC,WAA0B,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;IAAA,IACjCG,aAA4B,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;IAEnC,MAAMI,SAAS,GAAGR,IAAI,KAAK,MAAM,GAC7BrB,aAAa,CAACsB,KAAK,GACnBD,IAAI,KAAK,QAAQ,GACdS,CAAS,IAAKtB,eAAe,CAACc,KAAK,CAACE,WAAW,EAAEM,CAAC,CAAC,GACnDA,CAAS,IAAKd,eAAe,CAACM,KAAK,CAACE,WAAW,EAAEI,aAAa,EAAEE,CAAC,CAAC;IAEzE,MAAMC,SAAS,GAAGV,IAAI,KAAK,MAAM,GAC5BS,CAAS,IAAK5C,aAAa,CAAC4C,CAAC,EAAEP,SAAS,EAAE,IAAI,CAAC,CAACD,KAAK,GACrDQ,CAAS,IAAK3C,uBAAuB,CAAC2C,CAAC,EAAEP,SAAS,CAAC;IAExD,MAAMS,KAAK,GAAGX,IAAI,KAAK,MAAM,GAAG,EAAE,GAAG,EAAE;IACvC,KAAK,IAAIY,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAID,KAAK,EAAEC,CAAC,EAAE,EAAE;MAC/BX,KAAK,GAAGS,SAAS,CAACT,KAAK,CAAC;MACxB,IAAIO,SAAS,CAACP,KAAK,CAAC,EAAE;IACxB;IACA,OAAOA,KAAK;EACd;EAEA,OAAO;IACLtB,aAAa;IACbQ,eAAe;IACfQ,eAAe;IACfI;EACF,CAAC;AACH","ignoreList":[]}